/*! 
 Build based on gin-vue-admin 
 Time : 1699796219000 */
import{v as a,a as e,r as t,o as l,c as o,d as s,w as r,g as p,b as i,M as d,N as m,h as u,l as n,E as c,p as B,i as C}from"./087AC4D233B64EB0index.js";import{E,a as b}from"./087AC4D233B64EB0table-column.js";import"./087AC4D233B64EB0checkbox.js";/* empty css                       *//* empty css                      */import"./087AC4D233B64EB0scrollbar.js";import"./087AC4D233B64EB0tag.js";import{a as v,E as h}from"./087AC4D233B64EB0form-item.js";/* empty css                     */import{E as A,a as f}from"./087AC4D233B64EB0select.js";import{E as j}from"./087AC4D233B64EB0popover.js";import{E as y}from"./087AC4D233B64EB0empty.js";/* empty css                      */import{_ as D}from"./087AC4D233B64EB0warningBar.js";import{g as _}from"./087AC4D233B64EB0autoCode.js";import{_ as w}from"./087AC4D233B64EB0_plugin-vue_export-helper.js";import"./087AC4D233B64EB0index21.js";import"./087AC4D233B64EB0_Uint8Array.js";import"./087AC4D233B64EB0_initCloneObject.js";import"./087AC4D233B64EB0hasIn.js";import"./087AC4D233B64EB0debounce.js";import"./087AC4D233B64EB0isEqual.js";import"./087AC4D233B64EB0castArray.js";import"./087AC4D233B64EB0_baseClone.js";import"./087AC4D233B64EB0index22.js";import"./087AC4D233B64EB0strings.js";import"./087AC4D233B64EB0dropdown.js";/* empty css                     */const k={class:"gva-table-box"},x={key:0},g={class:"secret"},V={key:1},G=(a=>(B("data-v-87148612"),a=a(),C(),a))((()=>i("p",null,"确定要删除并返回吗？",-1))),T={style:{"text-align":"right","margin-top":"8px"}},S={class:"tables"},U={key:1,class:"text"},q=w({__name:"chatTable",setup(B){const C=e(null),w=t({sk:""}),q=e(""),K=async()=>{const e=await a({url:"/chatGpt/getSK",method:"get"});C.value=e.data.ok};K(),(async()=>{const a=await _();0===a.code&&(z.value=a.data.dbs)})();const R=async()=>{var e;0===(await(e=w,a({url:"/chatGpt/createSK",method:"post",data:e}))).code&&await K()},I=async()=>{0===(await a({url:"/chatGpt/deleteSK",method:"delete"})).code&&await K()},P=e({dbname:"",chat:""}),z=e([]),L=e([]),M=async()=>{const e=await(t=P.value,a({url:"/chatGpt/getTable",method:"post",data:t}));var t;0===e.code&&(L.value=e.data.results||[]),q.value=e.data.sql};return(a,e)=>{const t=n,B=c,_=y,K=j,N=v,O=A,Q=f,F=h,H=E,J=b;return l(),o("div",k,[s(D,{title:"使用GPT-3.5模型，存在一定不稳定性，成功率为50%左右，使用GPT-4可以极大提升成功率，但是费用较高。"}),C.value?(l(),o("div",V,[s(F,{model:P.value,"label-width":"120px"},{default:r((()=>[s(N,{label:"删除当前sk："},{default:r((()=>[s(K,{placement:"top",width:"160"},{reference:r((()=>[s(B,{type:"primary",link:"",icon:"delete"},{default:r((()=>[p("删除")])),_:1})])),default:r((()=>[G,i("div",T,[s(B,{type:"primary",onClick:I},{default:r((()=>[p("确定")])),_:1})])])),_:1})])),_:1}),s(N,{label:"查询db名称："},{default:r((()=>[s(Q,{modelValue:P.value.dbname,"onUpdate:modelValue":e[1]||(e[1]=a=>P.value.dbname=a),placeholder:"请选择库",style:{width:"115px"}},{default:r((()=>[(l(!0),o(d,null,m(z.value,((a,e)=>(l(),u(O,{key:e,label:a.database,value:a.database},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(N,{label:"查询db描述："},{default:r((()=>[s(t,{modelValue:P.value.chat,"onUpdate:modelValue":e[2]||(e[2]=a=>P.value.chat=a),autosize:{minRows:2,maxRows:4},type:"textarea",clearable:"",placeholder:"请输入对话"},null,8,["modelValue"])])),_:1}),s(N,{label:"GPT生成SQL:"},{default:r((()=>[s(t,{modelValue:q.value,"onUpdate:modelValue":e[3]||(e[3]=a=>q.value=a),autosize:{minRows:2,maxRows:4},type:"textarea",disabled:"",placeholder:"此处展示自动生成的sql"},null,8,["modelValue"])])),_:1}),s(B,{type:"primary",onClick:M},{default:r((()=>[p("查询")])),_:1})])),_:1},8,["model"]),i("div",S,[L.value.length?(l(),u(J,{key:0,ref:"multipleTable",data:L.value,style:{width:"100%"},"tooltip-effect":"dark",height:"400px"},{default:r((()=>[(l(!0),o(d,null,m(L.value[0],((a,e)=>(l(),u(H,{key:e,prop:e,label:e,"min-width":"200","show-overflow-tooltip":""},null,8,["prop","label"])))),128))])),_:1},8,["data"])):(l(),o("p",U,"请在对话框输入你需要AI帮你查询的内容：）"))])])):(l(),o("div",x,[s(t,{modelValue:w.sk,"onUpdate:modelValue":e[0]||(e[0]=a=>w.sk=a),class:"query-ipt",placeholder:"请输入您的ChatGpt SK",clearable:""},null,8,["modelValue"]),s(B,{type:"primary",onClick:R},{default:r((()=>[p("保存")])),_:1}),i("div",g,[s(_,{description:"请到gpt网站获取您的sk：https://platform.openai.com/account/api-keys"})])]))])}}},[["__scopeId","data-v-87148612"]]);export{q as default};
